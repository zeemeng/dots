#!/usr/bin/env sh


mkdir -p "${PKG_CONFIG_DEST}/.bash_profile.d"
mkdir -p "${PKG_CONFIG_DEST}/.zprofile.d"

SHELL_INIT_1="
export PYENV_ROOT='${PKG_CONFIG_DEST}/.pyenv'

# Build optimization flags for 'pyenv's 'python-build' plugin. See ref below.
# https://github.com/pyenv/pyenv/tree/master/plugins/python-build
export PYTHON_CONFIGURE_OPTS='--enable-optimizations --with-lto'
export PYTHON_CFLAGS='-march=native -mtune=native'

export PYTHON_BUILD_SKIP_MIRROR=1
"
SHELL_INIT_2='
command -v pyenv >/dev/null || export PATH="$PYENV_ROOT/bin:$PATH"
eval "$(pyenv init -)"
'

printf "$SHELL_INIT_1" >>  "${PKG_CONFIG_DEST}/.bash_profile.d/pyenv"
printf "$SHELL_INIT_2" >>  "${PKG_CONFIG_DEST}/.bash_profile.d/pyenv"

printf "$SHELL_INIT_1" >>  "${PKG_CONFIG_DEST}/.zprofile.d/pyenv"
printf "$SHELL_INIT_2" >>  "${PKG_CONFIG_DEST}/.zprofile.d/pyenv"

