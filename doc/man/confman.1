.\" Automatically generated by Pandoc 3.4
.\"
.TH "CONFMAN" "1" "November 2024" "confman 0.10"
.SH NAME
confman \- manage and configure packages
.SH SYNOPSIS
\f[B]confman\f[R] [\f[B]\-iIs\f[R]] [\f[B]\-m\f[R] \f[I]pkg_mgr\f[R]]
[\f[B]\-d\f[R] \f[I]config_dest\f[R]] [\f[B]\-g\f[R]
\f[I]config_repo\f[R]] [\f[B]\-p\f[R] \f[I]prompt_lvl\f[R]]
[\f[B]\-f\f[R] \f[I]pkg_list\f[R]] [\f[I]package \&...\f[R]]
.PD 0
.P
.PD
\f[B]confman\f[R] [\f[B]\-uUr\f[R]] [\f[B]\-m\f[R] \f[I]pkg_mgr\f[R]]
[\f[B]\-d\f[R] \f[I]config_dest\f[R]] [\f[B]\-g\f[R]
\f[I]config_repo\f[R]] [\f[B]\-p\f[R] \f[I]prompt_lvl\f[R]]
[\f[B]\-f\f[R] \f[I]pkg_list\f[R]] [\f[I]package \&...\f[R]]
.PD 0
.P
.PD
\f[B]confman\f[R] [\f[B]\-l\f[R]] [\f[B]\-f\f[R] \f[I]pkg_list\f[R]]
[\f[I]package \&...\f[R]]
.PD 0
.P
.PD
\f[B]confman\f[R] [\f[B]\-vhH\f[R]]
.SH DESCRIPTION
\f[B]confman\f[R] can be used to install, uninstall, configure, and
remove configuration for a list of selected packages.
Selected packages must be defined in a target package repository (see
\f[I]ENVIRONMENT\f[R]).
If no selected package is specified, \f[B]confman\f[R] selects all
packages defined in the repository.
If no \f[I]Operation\f[R] option is provided, \f[B]confman\f[R] installs
and configures the selected package(s) (same effect as option
\f[B]\-I\f[R]).
Management operations for each package can be redefined via custom
scripts (see \f[I]FILES\f[R]).
Package names must conform to certain requirements as specified in the
\f[I]NOTES\f[R] section.
.SH OPTIONS
.SS Operation
.TP
\f[B]\-h\f[R]
Print a brief help message and exit.
.TP
\f[B]\-H\f[R]
Show the manpage for \f[B]confman\f[R].
.TP
\f[B]\-i\f[R]
Install the selected packages.
.TP
\f[B]\-I\f[R]
Install and configure the selected packages.
Implies both the \f[B]\-i\f[R] and \f[B]\-s\f[R] options.
.TP
\f[B]\-l\f[R]
List and show information about selected packages.
.TP
\f[B]\-s\f[R]
Set up / configure the selected packages.
.TP
\f[B]\-r\f[R]
Remove configuration for the selected packages.
.TP
\f[B]\-u\f[R]
Uninstall the selected packages.
Package configurations are NOT implicitly removed.
.TP
\f[B]\-U\f[R]
Uninstall and remove configuration for the selected packages.
.TP
\f[B]\-v\f[R]
Print version information and exit.
.SS Configuration
.TP
\f[B]\-d\f[R] \f[I]config_dest\f[R]
Specify the destination where symlinks of package data and configuration
files are created at by the default package configuration operation.
The value of \f[I]config_dest\f[R] overrides that of the CONFMAN_DEST
variable (see \f[I]ENVIRONMENT\f[R]), and would be assigned to it if
valid.
If neither \f[I]config_dest\f[R] nor CONFMAN_DEST are specified, the
value of the HOME environment variable is used by default.
.TP
\f[B]\-f\f[R] \f[I]pkg_list\f[R]
Read newline\-separated package names from file \f[I]pkg_list\f[R] and
add them to the list of selected packages.
.TP
\f[B]\-g\f[R] \f[I]config_repo\f[R]
Specify the directory corresponding to the package configurations
repository.
The value of \f[I]config_repo\f[R] overrides that of the CONFMAN_REPO
variable (see \f[I]ENVIRONMENT\f[R]), and would be assigned to it if
valid.
If neither \f[I]config_repo\f[R] nor CONFMAN_REPO are specified,
\f[I]packages/\f[R] within the parent directory of the \f[B]confman\f[R]
executable is used by default.
The repository shall contain a child directory for each package that
could be provided to \f[B]confman\f[R] as a selected package.
Such a directory must have the same name as its associated package, and
may contain custom installation scripts, configuration scripts, and data
(see \f[B]FILES\f[R]).
Its value is overriden by that of option \f[B]\-g\f[R]\[cq]s argument if
the latter is specified
.TP
\f[B]\-m\f[R] \f[I]pkg_mgr\f[R]
The back\-end package manager to use for installation and
uninstallation.
Can be an absolute path to an executable or a program name if it can be
found in PATH.
If both this option and the CONFMAN_MGR variable (see
\f[I]ENVIRONMENT\f[R]) are set when this program is invoked, the value
of the option argument \f[I]pkg_mgr\f[R] overrides that of the variable,
and CONFMAN_MGR will be reassigned to the value of \f[I]pkg_mgr\f[R].
If both are not provided when this program is invoked, \f[B]confman\f[R]
will automatically attempt to select and use an appropriate package
manager command, which is then assigned to CONFMAN_MGR.
.RS
.PP
\f[B]confman\f[R] sets the \f[I]export\f[R] variable attribute on
CONFMAN_MGR, therefore this variable is available in the execution
environment of package\-specific custom scripts (see \f[I]FILES\f[R]).
.RE
.TP
\f[B]\-p\f[R] \f[I]prompt_lvl\f[R]
Set the amount/level of prompts presented by \f[B]confman\f[R].
The argument \f[I]prompt_lvl\f[R] may be one of three values:
\f[I]0\f[R], \f[I]1\f[R], or \f[I]2\f[R].
If \f[I]0\f[R] is specified, no prompt or interactive inquiry is
generated for all default operations performed by \f[B]confman\f[R].
If \f[I]1\f[R] is specified, minimal prompting is presented (default
behaviour).
For example, a prompt is presented to validate the set of packages on
which to perform certain actions.
If \f[I]2\f[R] is specified, extensive prompting is enable for default
operations.
In which case, a confirmation prompt is presented before any operation
is performed by the selected back\-end package manager for every target
package.
Any invalid value of \f[I]prompt_lvl\f[R] is ignored.
.RS
.PP
If a valid value of \f[I]prompt_lvl\f[R] is specified, it is assigned to
the variable CONFMAN_PROMPT.
If both the \f[B]\-p\f[R] option and the CONFMAN_PROMPT variable is set
when this program is invoked, a valid value of \f[I]prompt_lvl\f[R]
overrides the value of the variable.
Since \f[B]confman\f[R] sets the \f[I]export\f[R] variable attribute on
CONFMAN_PROMPT, this variable is available in the execution environment
of package\-specific custom scripts (see \f[I]FILES\f[R]).
.RE
.SH ENVIRONMENT
\f[B]confman\f[R] sets the \f[I]export\f[R] attribute on the following
shell variables, therefore these are available in the execution
environment of package\-specific custom scripts (see \f[I]FILES\f[R])
when such scripts are invoked by \f[B]confman\f[R].
.TP
PKG
The name of the package currently being processed by \f[B]confman\f[R].
.TP
CONFMAN_DEST
The destination where symlinks of package data and configuration files
are created at by the default package configuration operation.
By default, it is set to the value of the HOME environment variable.
Its value is overriden by that of option \f[B]\-d\f[R]\[cq]s argument if
the latter is specified.
.TP
CONFMAN_DIR
The directory portion of the canonicalized pathname (as returned by the
\f[B]realpath\f[R] utility) for the \f[B]confman\f[R] executable.
.TP
CONFMAN_LOG
Path to an executable utility for logging \f[B]confman\f[R]\-related,
formatted log messages.
It can be invoked in user scripts, and takes 2 or more arguments.
The first argument determines the formatting and standard stream
destination of the log message.
It shall have one of the following values: \f[I]info\f[R],
\f[I]success\f[R], \f[I]warning\f[R], \f[I]error\f[R],
\f[I]highlight\f[R].
The remaining arguments are used as the content of the formatted log
message.
.TP
CONFMAN_MGR
The back\-end package manager to use for installation and
uninstallation.
Can be an absolute path to an executable or a program name if it can be
found in PATH.
Its value is overriden by that of option \f[B]\-m\f[R]\[cq]s argument if
the latter is specified.
If both this variable and the \f[B]\-m\f[R] option are not provided when
this program is invoked, \f[B]confman\f[R] will automatically attempt to
select and use an appropriate package manager command, which is then
assigned to CONFMAN_MGR.
.TP
CONFMAN_REPO
The directory corresponding to the package configurations repository.
By default, it is set to \f[I]packages/\f[R] within the parent directory
of the \f[B]confman\f[R] executable.
Its value is overriden by that of option \f[B]\-g\f[R]\[cq]s argument if
the latter is specified.
The repository shall contain a child directory for each package that
could be provided to \f[B]confman\f[R] as a selected package.
Such a directory must have the same name as its associated package, and
may contain custom installation scripts, configuration scripts, and data
(see \f[B]FILES\f[R]).
Its value is overriden by that of option \f[B]\-g\f[R]\[cq]s argument if
the latter is specified
.TP
CONFMAN_PROMPT
The amount/level of prompts presented by \f[B]confman\f[R].
It may take one of three values: \f[I]0\f[R], \f[I]1\f[R], or
\f[I]2\f[R].
If set to \f[I]0\f[R], no prompt or interactive inquiry is generated for
all default operations performed by \f[B]confman\f[R].
If set to \f[I]1\f[R] (the default value), minimal prompting is
presented.
For example, a prompt is presented to validate the set of packages on
which to perform certain actions.
If set to \f[I]2\f[R], extensive prompting is enable for default
operations.
In which case, a confirmation prompt is presented before any operation
is performed by the selected back\-end package manager for every target
package.
Any invalid value is replaced with \f[I]1\f[R].
.RS
.PP
If the option \f[B]\-p\f[R] is specified and has a valid argument
\f[I]prompt_lvl\f[R], it overrides the value set for this variable.
CONFMAN_PROMPT would then be reassigned to the value of
\f[I]prompt_lvl\f[R].
.RE
.TP
CONFMAN_TASK
Path to an executable utility for dispatching the default
\f[I]install\f[R], \f[I]uninstall\f[R], \f[I]configure\f[R],
\f[I]unconfigure\f[R] operations.
It can be invoked in user scripts, and takes at least 1 argument.
The first argument is mandatory and its value shall correspond to the
operation to be dispatched.
Environment variables provided on invocation of this utility will be
propagated to downstream executables that itself would invoke.
.SH FILES
.TP
\f[I]$CONFMAN_REPO/<package_name>/\f[R]
Each directory immediately below the package repository (path given by
the environment variable CONFMAN_REPO) shall be associated with a
package and may contain installation and configuration scripts, as well
as configuration data for that package.
The name of such a directory MUST match the name of a package that could
be provided to \f[B]confman\f[R] as a selected package.
Furthermore, during the default installation and uninstallation
operations, this name is provided as the target to the selected package
manager (see option \f[B]\-m\f[R]).
If this name cannot be reliably used as the target for all supported
package managers, then custom installation scripts (see below) should be
created.
.TP
\f[I]$CONFMAN_REPO/<package_name>/data/\f[R]
Optional.
Directory which contains package configuration files and data.
If setup scripts (see below) for the associated package are not
provided, by default when the package is set up / configured, all files
within this directory are symlinked to the location specified by the
CONFMAN_DEST environment variable.
Similarly, if setup scripts for the associated package are not provided,
by default when the package configuration is removed by
\f[B]confman\f[R], those symlinks are removed.
.TP
\f[I]$CONFMAN_REPO/<package_name>/platform\f[R]
Optional.
If this file exists, its content shall be a newline\-separated list of
case insensitive BRE patterns that may match any part of the \f[I]uname
\-s\f[R] command\[cq]s output on platforms/operating systems for which
the package is compatible with.
Packages which designate such a platform compatibility list will
\f[I]ONLY\f[R] be subject to any operation on its supported platforms.
.TP
\f[I]$CONFMAN_REPO/<package_name>/noinstall\f[R]
Optional.
If this file exists, installation for this package is ALWAYS skipped.
.TP
\f[I]$CONFMAN_REPO/<package_name>/preinstall\f[R]
Optional.
Pre\-installation script that is executed before its associated package
undergoes default installation, or before the
\f[I]$CONFMAN_REPO/<package_name>/install\f[R] script if it exists.
.TP
\f[I]$CONFMAN_REPO/<package_name>/install\f[R]
Optional.
Installation script that replaces the default package installation
operation.
The default package installation operation simply involves installing a
selected package using the selected package manager.
.TP
\f[I]$CONFMAN_REPO/<package_name>/postinstall\f[R]
Optional.
Post\-installation script that is executed after its associated package
undergoes default installation, or after the
\f[I]$CONFMAN_REPO/<package_name>/install\f[R] script if it exists.
.TP
\f[I]$CONFMAN_REPO/<package_name>/uninstall\f[R]
Optional.
Uninstallation script that replaces the default package uninstallation
operation.
The default package uninstallation operation simply involves
uninstalling a selected package using the selected package manager.
.TP
\f[I]$CONFMAN_REPO/<package_name>/noconfigure\f[R]
Optional.
If this file exists, setup / configuration for this package is ALWAYS
skipped.
.TP
\f[I]$CONFMAN_REPO/<package_name>/preconfigure\f[R]
Optional.
Pre\-configuration script that is executed before its associated
packages undergoes default setup / configuration, or before the
\f[I]$CONFMAN_REPO/<package_name>/setup\f[R] script if it exists.
.TP
\f[I]$CONFMAN_REPO/<package_name>/configure\f[R]
Optional.
Configuration script that replaces the default package setup /
configuration operation (see
\f[I]$CONFMAN_REPO/<package_name>/data/\f[R] above).
.TP
\f[I]$CONFMAN_REPO/<package_name>/postconfigure\f[R]
Optional.
Post\-configuration script that is executed after its associated
packages undergoes default setup / configuration, or after the
\f[I]$CONFMAN_REPO/<package_name>/setup\f[R] script if it exists.
.TP
\f[I]$CONFMAN_REPO/<package_name>/unconfigure\f[R]
Optional.
Configuration removal script that replaces the default package
configuration removal operation (see
\f[I]$CONFMAN_REPO/<package_name>/data/\f[R] above).
.SH NOTES
A valid package name shall not consist strictly of whitespace characters
as defined by the \f[B]space\f[R] character class of the shell
environment locale.
A valid package name shall also not contain any occurance of the
<newline> character which is reserved for use as a delimiter by
\f[B]confman\f[R].
.PP
To be recognizable / selectable by \f[B]confman\f[R], each
\f[I]package\f[R] specified as command operand, or specified within a
\f[I]pkg_list\f[R] file as required by the \f[B]\-f\f[R] option, must
have an associated sub\-directory of the same name within the targeted
package repository (see variable CONFMAN_REPO).
